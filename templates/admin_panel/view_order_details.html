{% extends 'admin_panel/admin_base.html' %}
{% load static %}
{% block title %}Orders{% endblock title %}
{% block orders %}{% endblock orders %}
{% block content %}
<div class="main-panel" style="margin-left: 300px;">
    <div class="content-wrapper">
      <div class="row">
        <div class="mt-5 col-12 grid-margin mx-auto">
          <div class="card mb-5">
            <div class="card-body">
              <div class="mb-5">
                <ul class="navbar-nav w-100">
                  <li class="nav-item w-100"></li>
                </ul>
              </div>
              <div class="col-md-6 ms-3">
                <h3>View Orders</h3>
              </div>
              <nav>
                <ol class="breadcrumb ms-4">
                  <li class="breadcrumb-item">Admin</li>
                  <li class="breadcrumb-item">Orders</li>
                  <li class="breadcrumb-item active">View Orders</li>
                </ol>
              </nav>
              <div class="table-responsive">
                <div class="container-fluid d-flex flex-column justify-content-center">
                  <div class="card col-12 my-3 mx-auto p-2" style="border: 0.2px solid #494949;">
                    <div class="card-header d-flex justify-content-between w-100">
                      <div class="d-flex flex-column">
                        <p style="color: 
                        {% if obj.status == 'Order confirmed' %}blue
                        {% elif obj.status == 'Shipped' %}blue
                        {% elif obj.status == 'Out for delivery' %}orange
                        {% elif obj.status == 'Delivered' %}green
                        {% elif obj.status == 'Cancelled' %}red
                        {% endif %};">
                        {{ obj.status }}
                      </p>
                      <h4 style="color: {% if obj.order.payment_status == 'success' %}green{% else %}red{% endif %}">
                        Payment Status: {{ obj.order.payment_status }}

                    </h4>                       
                     <h6> Expected Delivery {{obj.order.expected_delivery_date}}</h6>
                      </div>
                    </div>
                    <hr class="m-0 mb-1">
                    <div>
                      <!-- <h6 class="mx-5 mb-2">Delivery Expect on : <b>date</b></h6> -->
                    </div>
                    <div class="card-body row col-12 d-flex">
                      <div class="col-md-4 col-12 mx-auto">
                        <img class="mt-4" src="{{obj.variant.product.productimage_set.first.image.url}}" style="height: 400px; border-radius: 7px;" alt="">
                        <p class="card-text"></p>
                        <!-- <a href="#" class="btn btn-dark">Go somewhere</a> -->
                      </div>
                      <div class="col-md-7 col-12">
                        <h4 class="card-title">{{obj.variant.product.name}}</h4>

                        <p class="card-text">
                          <p>Order ID: <b>{{obj.order.order_id}}</b></p>
                          <p>Quantity: <b>{{obj.quantity}}</b></p>
                          <p>Order Date: <b>{{obj.order.order_date}}</b></p>
                          

                          Payment Method: {{ obj.order.payment_method }}
                        </p>
                        <h5 class="card-title mb-2">RS: {{ obj.total_price }}</h5>
                        <hr class="bg-secondary">
                        <h5 class="card-title" style="font-size: 15px;">Shipping Address</h5>
                        <h6 class="card-title" style="font-size: 15px;"> FULL NAME : {{ obj.order.address.full_name }}</h6>
                        <p class="card-text"><b>Location:</b><br>
                            {{obj.order.address.address_line}},<br>
                            {{obj.order.address.city}},<br>
                            {{obj.order.address.state}},<br>
                            {{obj.order.address.landmark}},<br>
                            {{obj.order.address.pincode}}

                        <p class="card-text"><b>{{obj.order.address.mobile_number}}</b></p>   
                        
                        
                        <hr>
                        <h5 class="card-title" style="font-size: 20px;">Change Order Status</h5>
                      <h6><b>Current Status: </b> 
                        <span style="color: 
                          {% if obj.status == 'Order confirmed' %}blue
                          {% elif obj.status == 'Shipped' %}blue
                          {% elif obj.status == 'Out for delivery' %}orange
                          {% elif obj.status == 'Delivered' %}Green
                          {% elif obj.status == 'Cancelled' %}red
                          {% endif %};">
                          {{ obj.status }}
                        </span><br>

                        {% if obj.status != 'Cancelled' %}
                          <form method="post" action="../change_status/{{obj.id}}">
                            {% csrf_token %}
                            <div class="btn-group mt-3" role="group" aria-label="Status Update">
                              <input type="radio" class="btn-check" name="statusRadio" value="Order Confirmed" id="orderConfirmedBtn" autocomplete="off" {% if obj.status == 'Order Confirmed' %}checked{% endif %}>
                              <label class="btn btn-outline-dark me-3" for="orderConfirmedBtn">Order Confirmed</label>
                              
                              <input type="radio" class="btn-check" name="statusRadio" value="Shipped" id="shippedBtn" autocomplete="off" {% if obj.status == 'Shipped' %}checked{% endif %}>
                              <label class="btn btn-outline-primary me-3" for="shippedBtn">Shipped</label>
                              
                              <input type="radio" class="btn-check" name="statusRadio" value="Out for Delivery" id="outForDeliveryBtn" autocomplete="off" {% if obj.status == 'Out for Delivery' %}checked{% endif %}>
                              <label class="btn btn-outline-warning me-3" for="outForDeliveryBtn">Out for Delivery</label>
                              
                              <input type="radio" class="btn-check" name="statusRadio" value="Delivered" id="deliveredBtn" autocomplete="off" {% if obj.status == 'Delivered' %}checked{% endif %}>
                              <label class="btn btn-outline-success me-3" for="deliveredBtn">Delivered</label>
                            </div>
                            
                            <br><br>
                            
                            <button type="submit" class="btn btn-dark">Update Changes</button>
                          </form>

                  
                        {% else %}
                          <div class="text-danger mt-3">
                            <h3><b> Order is Cancelled</b></h3>
                          </div>
                        {% endif %}
                      </h6>
                      </div>
                    </div>
                  </div>
                </div>
                
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
  

{% endblock %}